# Домашнее задание к занятию «Основы Terraform. Yandex Cloud» - Пугач Евгений.


---

## `Создание ветки terraform-02`

![Скриншот 1](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-10_13-07-20.png)

---

## `Задание 1`

В качестве решения приложите:

- скриншот ЛК Yandex Cloud с созданной ВМ;
- скриншот успешного подключения к консоли ВМ через ssh;
- ответы на вопросы:
  - В чем заключается суть намеренно допущенных в коде ошибок? 
  - Как в процессе обучения могут пригодиться параметры `preemptible = true` и  
 `core_fraction=5` в параметрах ВМ?

### Ответ:

`Скриншот ЛК Yandex Cloud с созданной ВМ`
![Скриншот 2](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-05_17-05-41.png)

`Скриншот подключения к консоли ВМ через ssh`
![Скриншот 3](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-05_17-20-52.png)

`Скриншот с ошибками`
![Скриншот 4](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-10_14-31-07.png)

Мною было найдено несколько ошибок:
- орфографическая в написании слова `standart`, испраил на `standard`;
- существует только три версии платформы `standard`, исправил на `v1`;
- на всех платформах standard доступно минимум 2 ядра, в конфиге указано 1 ядро, исправил на 2.

Параметры виртуальных машин:
- `preemptible = true` означает, что ВМ прерываемая, это хорошо тем, что если забыть ее выключить, она  
 будет выключена автоматически в течении 24 часов с момента запуска, это позволит сохранить финансы;
- `core_fraction=5` указывает на уровень производительности CPU, от его значения зависит стоимость ВМ,  
 что в конечном итоге тоже позволяет экономить. 

---

## `Задание 2`

- Замените все хардкод-значения для ресурсов yandex_compute_image и yandex_compute_instance на отдельные  
 переменные. К названиям переменных ВМ добавьте в начало префикс vm_web_ .
- Объявите нужные переменные в файле variables.tf, обязательно указывайте тип переменной. Заполните их  
 default прежними значениями из main.tf.
- Проверьте terraform plan.

### Ответ:

![Скриншот 5](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-10_16-07-59.png)

---

## `Задание 3`

- Создайте в корне проекта файл 'vms_platform.tf' . Перенесите в него все переменные первой ВМ.
- Скопируйте блок ресурса и создайте с его помощью вторую ВМ в файле main.tf: "netology-develop-platform-db",  
 cores = 2, memory = 2, core_fraction = 20. Объявите её переменные с префиксом vm_db_ в том же файле  
 ('vms_platform.tf').
- Примените изменения.

### Ответ:

![Скриншот 6](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-10_16-23-03.png)

![Скриншот 7](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-09_18-34-55.png)

---

## `Задание 4`

- Объявите в файле outputs.tf output типа map, содержащий { instance_name = external_ip } для каждой  
 из ВМ. Примените изменения.

### Ответ:

![Скриншот 8](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-10_16-32-18.png)

---

## `Задание 5`

- В файле locals.tf опишите в одном local-блоке имя каждой ВМ, используйте интерполяцию ${..} с несколькими  
 переменными по примеру из лекции.
- Замените переменные с именами ВМ из файла variables.tf на созданные вами local-переменные. Примените изменения.

### Ответ:

![Скриншот 9](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-09_21-26-23.png)

---

## `Задание 6`

- Вместо использования трёх переменных ".._cores",".._memory",".._core_fraction" в блоке resources {...},  
 объедините их в переменные типа map с именами "vm_web_resources" и "vm_db_resources". 
- Также поступите с блоком metadata {serial-port-enable, ssh-keys}, эта переменная должна быть общая для  
 всех ваших ВМ.
- Проверьте terraform plan. Изменений быть не должно.

### Ответ:

![Скриншот 10](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-10_16-44-37.png)

---

### Дополнительные задания (со звездочкой*)

## `Задание 7`

`Выполните следующие задания:`
- Напишите, какой командой можно отобразить второй элемент списка test_list.
- Найдите длину списка test_list с помощью функции length(<имя переменной>).
- Напишите, какой командой можно отобразить значение ключа admin из map test_map.
- Напишите interpolation-выражение, результатом которого будет: "John is admin for production server based on  
 OS ubuntu-20-04 with X vcpu, Y ram and Z virtual disks", используйте данные из переменных test_list, test_map,  
 servers и функцию length() для подстановки значений.

### Ответ:

![Скриншот 11](https://github.com/PugachEV72/ter-hw-01/blob/terraform-02/img/2023-09-10_00-14-31.png)

---

